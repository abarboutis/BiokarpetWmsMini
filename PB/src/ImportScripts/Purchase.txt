[IMPORT]
MODULE=TStoreSupTrade
DESTINATION=FINTRADE,STORETRADE,STORETRADELINES
READER=ATLANTIS

[ATLANTIS]
MAINTABLE=QRY1

[IMPORTSET]
QRY1=SELECT DISTINCT ERPCompID, ReceiveID,AlpisStoreTransDate, ERPTransSeriesID, ERPSupplierID, ERPTransCode , 
ERPFromStoreID,ERPToStoreID,1 AS LOCALRATE,ISNULL(CurID,10) AS CURID FROM ZWMSMINISTORETRANS WHERE  isnew = 1 AND DocType=1 ORDER BY  ReceiveID;
QRY2=SELECT  ERPItemID, ERPItemMUnit, ERPItemQty, ERPItemUnitPrice, ERPItemQtyPrice,ERPLotID,ERPLotCode FROM ZWMSMINISTORETRANS  
WHERE  isnew = 1 AND ReceiveID=:$ReceiveID;
[FINTRADE]
DSRID=QRY1.ERPTransSeriesID
SUPID=QRY1.ERPSupplierID
TRADECODE=QRY1.ERPTransCode 
CURID=QRY1.CURID
LOCALRATE=QRY1.LOCALRATE
ZALPISRECEIVEID=QRY1.RECEIVEID

[STORETRADE]
STOID=QRY1.ERPFromStoreID
SECSTOID=QRY1.ERPToStoreID

[STORETRADELINES]
ITEID=QRY2.ERPItemID
PARID=QRY2.ERPLotID
LOTCODE=QRY2.ERPLotCode
PRIMARYQTY=QRY2.ERPItemQty

[AFTERIMPORT]
UPDATE ZWMSMINISTORETRANS SET ISNEW=0 WHERE doctype=1;

